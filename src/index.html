<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Тестирование</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <h1>Пройдите тест!</h1>
    <h3 id="question">1. Кому обязан доложить уполномоченный секретного отдела в случае нарушения обучаемыми порядка руководства хранения и обращения с носителями сведений, составляющих государственную тайну?</h3>
    <ul>
      <li><input type="radio" id="ans-1" name="answer" value="1"
        checked>
 <label id="l1" for="ans-1">Непосредственному начальнику и руководителю занятий.</label></li>
      <li><input type="radio" id="ans-2" name="answer" value="2">
 <label id="l2" for="ans-2">Непосредственному начальнику.</label></li>
      <li><input type="radio" id="ans-3" name="answer" value="3">
 <label id="l3" for="ans-3">Руководителю занятий.</label></li>
    </ul>

    <button onclick="handleButton(this.id)" id="1">Ответить</button>

    <div id="wrong-block" hidden></div>
  </body>
  <script>
    let rightAnswers = [
      '2', '2', '1', '2', '3',
      '2', '3', '1', '3', '2'
    ];

    /**
     * Формат - вопрос, ответ, ответ, ответ
     **/
    let answers = [
      [
        '2. Порядок выдачи носителей сведений, составляющих государственную тайну, уполномоченными секретного отдела?',
        'По описи (форма №7 ИРС-2018).',
        'Под расписку в реестре (форма №11 ИРС-2018) или лицевом счете (форма №12 ИРС-2018).',
        'По жетону.'
      ],
      [
        '3. Обязанности дежурного учебного отделения (группы) по вопросам режима секретности по окончании занятий?',
        'Проверить рабочие места обучаемых на предмет возможного оставления носителей сведений, составляющих государственную тайну.',
        'Собрать секретные документы и сдать под охрану аудиторию.',
        'Собрать секретные документы, сдать под охрану аудиторию, доло жить руководителю занятия.'
      ],
      [
        '4. Проверки наличия сведений, составляющих Гос.тайну, в ходе учебного процесса командиры учебных отделений (групп) проводят?',
        'По окончании каждого занятия.',
        'Ежедневно по окончании самостоятельной подготовки с докладом начальникам курсов.',
        'Еженедельно.'
      ],
      [
        '5. Порядок уничтожения черновиков и проектов секретных документов, перепечатанных и бракованных листов?',
        'Уничтожаются по акту, комиссией не менее 3-х человек.',
        'Уничтожаются работником СДП с записью в журнале (форма №13 ИРС 2018).',
        'Уничтожаются под расписку исполнителя и работника СДП.'
      ],
      [
        '6. В какие сроки уничтожается опись носителей сведений, составляющих Гос.тайну, находящихся у исполнителя(форма №7 ИРС-2018)?',
        'После окончания годовой проверки наличия документов.',
        'Хранятся в течение 10 лет, после чего уничтожаются.',
        'После полного заполнения.'
      ],
      [
        '7. На кого возлагается ответственность за соблюдение установленного порядка работы с носителями сведений, составляющих Гос.тайну, в часы самоподготовки?',
        'На командира подразделения.',
        'На руководителя занятия.',
        'На командира учебного отделения (группы).'
      ],
      [
        '8. Порядок отчетности исполнителей перед секретным органом за числящиеся документы перед убытием в отпуск или командировку?',
        'Сдать или отчитаться перед подразделением СДП за НССГТ с записью в описи (форма №7 ИРС-2018).',
        'Документы передаются под роспись в описи (форма №7 ИРС-2018) лицу, назначенному начальником структурного подразделения.',
        'Разрешается не отчитываться, если срок командировки (отпуска) не превышает 15 суток.'
      ],
      [
        '9. У кого хранится ключ от аудитории во время перерыва?',
        'У командира учебной группы.',
        'У руководителя занятий.',
        'У дежурного по группе, осуществляющего охрану.'
      ],
      [
        '10. Порядок допуска лиц, нарушивших обязательство, связанное с защитой государственной тайны, к дальнейшей работе со сведениями, составляющими государственную тайну?',
        'После повторного изучения основных положений нормативных правовых актов по защите государственной тайны по письменному решению начальника академии.',
        'После повторного изучения основных положений нормативных правовых актов по защите государственной тайны, сдачи зачета начальнику службы ЗГТ и издания приказа начальника академии.',
        ' После повторного изучения основных положений нормативных правовых актов по защите государственной тайны и сдачи зачета по решению начальника службы ЗГТ.'
      ],
    ]

    let score = 0;

    let wrongAnswers = [];
    let wrongCounter = 0;

    function handleButton(buttonId)
    {
      
      let q = document.getElementById("question")
      let l1 = document.getElementById("l1")
      let l2 = document.getElementById("l2")
      let l3 = document.getElementById("l3")

      // Получаем оценку за текущий вопрос
      let button = document.getElementById(buttonId);
      id = parseInt(buttonId)
      let rightAnswer = rightAnswers[id - 1]
      let inputs = document.querySelectorAll('input')
      let myAnswer = 0
      inputs.forEach(input => {
        if (input.checked) {
          myAnswer = input.value
        }
      });
      if (rightAnswer == myAnswer) {
        score++
      }
      else {
        if (id == 1) {
          wrongAnswers.push([
            q.textContent,
            myAnswer == 1 ? l1.textContent : myAnswer == 2 ? l2.textContent : l3.textContent,
            rightAnswer == 1 ? l1.textContent : rightAnswer == 2 ? l2.textContent : l3.textContent
          ])
        }
        else {
          wrongAnswers.push([
            answers[id - 2][0],
            answers[id - 2][myAnswer],
            answers[id - 2][rightAnswer]])
        }
      }

      // Меняем информацию на странице
      if (id == 10) {
        // Ставим оценку
        button.hidden = true
        ul = document.getElementsByTagName('ul')[0]
        ul.hidden = true
        h1 = document.getElementsByTagName('h1')[0]
        h1.textContent = 'Тест завершен.'

        let points = 2
        if ((score == 9) || (score == 10)) {
          points = 5
        }
        if (score == 8) {
          points = 4
        }
        if ((score == 7) || (score == 6)) {
          points = 3
        }

        h3 = document.getElementsByTagName('h3')[0]
        h3.textContent = "Количество правильных ответов: " + score.toString() + "/10. Ваша оценка - " + points.toString() + "."
        if (wrongAnswers.length > 0) {
            let wrongDivAll = document.createElement('div')
          wrongAnswers.forEach(questionInfo => {
            let wrongDiv = document.createElement('div')
            let wrongADiv = document.createElement('div')
            wrongADiv.style.color = "red"
            let wrongQ = document.createTextNode("Вопрос: " + questionInfo[0])
            let wrongA = document.createTextNode("Ваш ответ: " + questionInfo[1])
            wrongADiv.appendChild(wrongA)
            let rightA = document.createTextNode("Правильный ответ: " + questionInfo[2])
            let rightADiv = document.createElement('div')
            rightADiv.style.color = "green"
            rightADiv.appendChild(rightA)
            
            wrongDiv.appendChild(wrongQ)
            wrongDiv.appendChild(wrongADiv)
            wrongDiv.appendChild(rightADiv)
            wrongDiv.classList.add("very-wrong-div")
            let hiddenDiv = document.getElementById("wrong-block")
            hiddenDiv.hidden = false
            document.body.insertBefore(wrongDiv, hiddenDiv)
          })
        }
        return
      }
      button.id = id + 1
      q.textContent = answers[id - 1][0]
      l1.textContent = answers[id - 1][1]
      l2.textContent = answers[id - 1][2]
      l3.textContent = answers[id - 1][3]

    }
  </script>
</html>
