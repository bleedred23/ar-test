<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Тестирование</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <h1>Пройдите тест!</h1>
    <h3 id="question">1. Кто обязан осуществлять проверку наличия носители сведений, составляющих государственную тайну по окончание занятия?</h3>
    <ul>
      <li><input type="radio" id="ans-1" name="answer" value="1"
        checked>
 <label id="l1" for="ans-1">Уполномоченный секретного отдела.</label></li>
      <li><input type="radio" id="ans-2" name="answer" value="2">
 <label id="l2" for="ans-2">Руководитель занятий.</label></li>
      <li><input type="radio" id="ans-3" name="answer" value="3">
 <label id="l3" for="ans-3">Командир учебного отделения.</label></li>
    </ul>

    <button onclick="handleButton(this.id)" id="1">Ответить</button>

    <div id="wrong-block" hidden></div>
  </body>
  <script>
    let rightAnswers = [
      '2', '3', '1', '2', '3',
      '2', '1', '3', '1', '3'
    ];

    /**
     * Формат - вопрос, ответ, ответ, ответ
     **/
    let answers = [
      [
        '2. Кто несёт ответственность за правильное определение степени секретности сведений, содержащихся в секретных работах, документах и изделиях?',
        'Исполнители Документов и их непосредственные начальники.',
        'Исполнителя Документов по согласованию со службой ЗГТ.',
        'Исполнители Документов и руководители, их утверждающие или подписывающие (организующие проведение работ).'
      ],
      [
        '3. Получение рабочих папок (чемоданов) со склада осуществляется?',
        'По жетону.',
        'По читательскому билету.',
        'По карточке выдачи.'
      ],
      [
        '4. Какой печатью опечатывается дверь аудитории во время перерыва?',
        'Печать уполномоченного секретного отдела.',
        'Печатью руководителя занятий.',
        'Печать дежурного.'
      ],
      [
        '5. Кому обязан доложить уполномоченный секретного отдела в случае нарушения обучаемыми порядка хранения и обращения с носителями сведений, составляющих государственную тайну?',
        'Начальнику факультета.',
        'Начальнику службы ЗГТ академии.',
        'Непосредственному начальнику.'
      ],
      [
        '6. Порядок отчётности исполнителей перед секретным органом за числящиеся документы перед убытием в отпуск или командировку?',
        'Документы передаются под роспись в описи (Форма №7 ИРС-2018).',
        'Сдать или отчитаться перед подразделением СДП за НССГТ с записью в описи (Форма №7 ИРС-2018).',
        'Разрешается не отчитываться, если срок командировки не превышает 15 суток.'
      ],
      [
        '7. В какие сроки проводит проверки наличия носители сведений, составляющих государственную тайну, в ходе учебного процесса обучаемые и уполномоченный секретного отдела?',
        'По окончании каждого занятия с докладом результатов проверки руководителю занятия.',
        'По окончании всех занятий с докладом командиру подразделения.',
        'Ежедневно по окончание самостоятельной подготовки с докладом командиру подразделения.'
      ],
      [
        '8. В каком журнале учитываются факты воздействия компьютерных вирусов?',
        'В журнале учета воздействия компьютерных вирусов.',
        'В рабочей тетради ответственного за ЗИ.',
        'В журнале учёта фактов несанкционированного доступа и воздействия компьютерных вирусов.'
      ],
      [
        '9. На какой срок выдается справка о допуске к государственной тайне?',
        'Выдается командируемому на время разовой командировки, на период выполнения задания, но не более чем на год, под роспись.',
        'Выдается командируемому на время разовой командировки, на период выполнения задания, но не более чем на шесть месяцев.',
        'Выдается командируемому на время разовой командировки.'
      ],
      [
        '10. У кого хранится ключ от аудитории во время перерыва?',
        'У командира учебной группы.',
        'У руководителя занятий.',
        'У дежурного по группе, осуществляющего охрану.'
      ],
    ]

    let score = 0;

    let wrongAnswers = [];
    let wrongCounter = 0;

    function handleButton(buttonId)
    {
      
      let q = document.getElementById("question")
      let l1 = document.getElementById("l1")
      let l2 = document.getElementById("l2")
      let l3 = document.getElementById("l3")

      // Получаем оценку за текущий вопрос
      let button = document.getElementById(buttonId);
      id = parseInt(buttonId)
      let rightAnswer = rightAnswers[id - 1]
      let inputs = document.querySelectorAll('input')
      let myAnswer = 0
      inputs.forEach(input => {
        if (input.checked) {
          myAnswer = input.value
        }
      });
      if (rightAnswer == myAnswer) {
        score++
      }
      else {
        if (id == 1) {
          wrongAnswers.push([
            q.textContent,
            myAnswer == 1 ? l1.textContent : myAnswer == 2 ? l2.textContent : l3.textContent,
            rightAnswer == 1 ? l1.textContent : rightAnswer == 2 ? l2.textContent : l3.textContent
          ])
        }
        else {
          wrongAnswers.push([
            answers[id - 2][0],
            answers[id - 2][myAnswer],
            answers[id - 2][rightAnswer]])
        }
      }

      // Меняем информацию на странице
      if (id == 10) {
        // Ставим оценку
        button.hidden = true
        ul = document.getElementsByTagName('ul')[0]
        ul.hidden = true
        h1 = document.getElementsByTagName('h1')[0]
        h1.textContent = 'Тест завершен.'

        let points = 2
        if ((score == 9) || (score == 10)) {
          points = 5
        }
        if (score == 8) {
          points = 4
        }
        if ((score == 7) || (score == 6)) {
          points = 3
        }

        h3 = document.getElementsByTagName('h3')[0]
        h3.textContent = "Количество правильных ответов: " + score.toString() + "/10. Ваша оценка - " + points.toString() + "."
        if (wrongAnswers.length > 0) {
            let wrongDivAll = document.createElement('div')
          wrongAnswers.forEach(questionInfo => {
            let wrongDiv = document.createElement('div')
            let wrongADiv = document.createElement('div')
            wrongADiv.style.color = "red"
            let wrongQ = document.createTextNode("Вопрос: " + questionInfo[0])
            let wrongA = document.createTextNode("Ваш ответ: " + questionInfo[1])
            wrongADiv.appendChild(wrongA)
            let rightA = document.createTextNode("Правильный ответ: " + questionInfo[2])
            let rightADiv = document.createElement('div')
            rightADiv.style.color = "green"
            rightADiv.appendChild(rightA)
            
            wrongDiv.appendChild(wrongQ)
            wrongDiv.appendChild(wrongADiv)
            wrongDiv.appendChild(rightADiv)
            wrongDiv.classList.add("very-wrong-div")
            let hiddenDiv = document.getElementById("wrong-block")
            hiddenDiv.hidden = false
            document.body.insertBefore(wrongDiv, hiddenDiv)
          })
        }
        return
      }
      button.id = id + 1
      q.textContent = answers[id - 1][0]
      l1.textContent = answers[id - 1][1]
      l2.textContent = answers[id - 1][2]
      l3.textContent = answers[id - 1][3]

    }
  </script>
</html>
